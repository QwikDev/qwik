module default {
  abstract type Timestamped {
    last_updated: datetime {
      rewrite insert, update using (datetime_of_statement());
    };
  }

  type User extending Timestamped {
    required name: str {
      constraint exclusive {
        errmessage := 'A user with that name already exists!';
      };
    };
    email: str {
      constraint exclusive {
        errmessage := 'A user with that email already exists!';
      };
    };
    has_profile: bool;

    index on (.name);
  }
}
